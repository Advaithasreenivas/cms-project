{% extends "layout.html" %}
{% block content %}

<div style="display:flex;justify-content:space-between;align-items:center">
  <div>
    <h1>Analytics</h1>
    <p class="subtext">Visual content insights</p>
  </div>

  <!-- Dark mode toggle -->
  <button id="themeToggle" class="btn-primary" style="width:auto;padding:10px 16px">
    ğŸŒ™ Dark
  </button>
</div>

<!-- LINE CHART -->
<div class="card glass fade-in">
  <h3>ğŸ“ˆ Content Growth (Last 6 entries)</h3>
  <canvas id="lineChart" height="120"></canvas>
</div>

<!-- BAR + PIE -->
<div class="card glass fade-in" style="margin-top:40px">
  <canvas id="barChart" height="110"></canvas>
</div>

<div class="card glass fade-in" style="margin-top:40px">
  <canvas id="pieChart" height="110"></canvas>
</div>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
document.addEventListener("DOMContentLoaded", () => {

  /* ---------- DATA ---------- */
  const published = {{ published }};
  const draft = {{ draft }};

  /* ---------- LINE CHART ---------- */
  new Chart(document.getElementById("lineChart"), {
    type: "line",
    data: {
      labels: ["Day 1","Day 2","Day 3","Day 4","Day 5","Today"],
      datasets: [{
        label: "Total Posts",
        data: [
          Math.max(0, published + draft - 5),
          Math.max(0, published + draft - 4),
          Math.max(0, published + draft - 3),
          Math.max(0, published + draft - 2),
          Math.max(0, published + draft - 1),
          published + draft
        ],
        borderColor: "#6366f1",
        backgroundColor: "rgba(99,102,241,0.15)",
        tension: 0.4,
        fill: true
      }]
    },
    options: {
      animation: {
        duration: 1200,
        easing: "easeOutQuart"
      },
      plugins: {
        legend: { display: false }
      },
      scales: {
        y: { beginAtZero: true }
      }
    }
  });

  /* ---------- BAR CHART ---------- */
  new Chart(document.getElementById("barChart"), {
    type: "bar",
    data: {
      labels: ["Published", "Draft"],
      datasets: [{
        data: [published, draft],
        backgroundColor: ["#34d399", "#facc15"],
        borderRadius: 14
      }]
    },
    options: {
      animation: { duration: 1000 },
      plugins: { legend: { display: false } },
      scales: { y: { beginAtZero: true } }
    }
  });

  /* ---------- PIE CHART ---------- */
  new Chart(document.getElementById("pieChart"), {
    type: "pie",
    data: {
      labels: ["Published", "Draft"],
      datasets: [{
        data: [published, draft],
        backgroundColor: ["#34d399", "#facc15"]
      }]
    },
    options: {
      animation: { duration: 1200 },
      plugins: {
        legend: { position: "bottom" }
      }
    }
  });

  /* ---------- DARK MODE ---------- */
  const toggle = document.getElementById("themeToggle");
  toggle.onclick = () => {
    document.body.classList.toggle("dark");
    toggle.textContent =
      document.body.classList.contains("dark") ? "â˜€ï¸ Light" : "ğŸŒ™ Dark";
  };
});
</script>

{% endblock %}